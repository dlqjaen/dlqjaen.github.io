## Vue 인스턴스

### 3.1 el, data, computed 옵션

data 옵션에 주어진 모든 속성들은 vue 인스턴스 내부에서 직접 이용되지 않고 Vue 인스턴스와 Data 옵션에 주어진 객체 사이에 **프록시**를 두어 처리합니다.

```
<div id="test">
  {{name}}
</div>
<script type="text/javascript">
var model = {
  name : "홍길동"
}
var vm = new Vue({
  el: '#test',
  data : model
})
</script>
```

따라서 위의 예제처럼 바로 {{name}}으로 접근해도 프록시 처러가 되면서 "홍길동"이라는 값이 출력된다.

data 옵션은 Vue인스턴스가 관찰하는 데이터 객체를 의미하므로 변경 사항은 즉시 감지됩니다.

> 프록시 : 데이터에 직접 접근하는 것이아닌 중간에서 요청받은 데이터를 대신 받아와 전달해주는 전달자

el 옵션은 Vue 인스턴스에 연결할 HTML DOM 요소를 지정합니다. 주의 할 점은 여러 요소에 지정할 수 없다는 것입니다.

동적으로 Vue 인스턴스와 HTML 요소를 연결할 수 있지만, 가능하다면 el 옵션은 Vue 인스턴스를 생성할 때 미리 지정하는 것을 권장합니다. 

computed 옵션에서 지정한 값은 함수였지만 Vue 인스턴스는 프록시 처리하여 마치 속성처럼 취급합니다.

```
<script type="text/javascript">
var vmSum = new Vue({
  el : "#example",
  data : { num : 0 },
  computed : {
    sum : function(){
      var n = Number(this.num);
      if(Number.isNaN(n) || n < 1>){
        return 0;
      }
      return ((1+n) * n) / 2;
    }
  }
});
</script>
```

계산형 속성은 읽기 전용이라 생각하기 쉽지만 set 메서드를 지정하면 쓰기 작업도 가능합니다.

### 3.2 메서드

Vue 인스턴스에서 사용할 메서드를 등록하는 옵션입니다.
등록된 메서드는 Vue 인스턴스를 이용해 직접 호출할 수도 있고, 디렉티브 표현식, 코수염 표현식으로도 사용할 수 있습니다.

```
<div id="example">
  <input type="text" v-model="num"><br />
  1부터 입력된 수까지의 합 : <span>{{sum()}}</span>
</div>
<script type="text/javascript">
var vmSum = new Vue({
  el : "#example",
  data : { num : 0 },
  methods : {
    sum : function(){
      var n = Number(this.sum);
      if(Number.isNaN(n) || n < 1){
        return 0;
      }
      return ((1+n) * n) / 2;
    }
  }
});
</script>
```

메서드와 계산형 속성을 사용했을 때 최종적인 결과물은 같아 보이지만 내부 작동 방식에는 차이가 있습니다. 계산형 속성은 종속된 값에 의해 결과값이 캐싱됩니다.

즉, 메서드를 사용한 값은 매번 메서드를 실행하여 값을 받아오지만 계산형 속성을 사용한 값은 캐싱된 결과값을 바로 리턴합니다.

메서드 작성시 ECMAScript6가 제공하는 화살표 함수는 사용해서선 안됩니다. 화살표 함수 내부에서 쓰이는 this는 Vue 인스턴스를 가리키지 않고, 전역 객체를 가리키기 때문에 Vue 인스턴스 내부 데이터에 접근할 수 없게 됩니다.

### 3.3 관찰 속성

Vue.js에서 하나의 데이터를 기반으로 다른 뎅니터를 변경할 필요가 있을 때 흔히 사용할 수 있는것으로 계산형 속성 외에 관찰 속성이란 것을 사용 할 수 있습니다.

주로 긴 시간이 필요한 비동기 처리에 적합하다는 특징을 가지고 있습니다.(watch 옵션을 통해 관찰 속성을 등록합니다.)

```
<div id="example">
  x : <input type="text" v-model="x" /><br />
  y : <input type="text" v-model="x" /><br />
  덧셈 결과 : {{sum}}
</div>
<script type="text/javascript">
var vm = new Vue({
  el : "#example",
  data : { x:0, y:0, sum:0},
  watch: {
    x : function(v){
      console.log("## x 변경");
      var result = Number(v) + Number(this.v);
      if (isNaN(result)){
        this.sum = 0;;
      } else {
        this.sum = result;
      }
    },
    y : function(v) {
      console.log("## y 변경");
      this.y = v;
      var result = Number(this.x) + Number(v);
      if(isNaN(result)) {
        this.sum = 0
      } else {
        this.sum = result;
      }
    }
  }
})
</script>
```

watch 옵션에 등록되는 것은 속성의 이름과 해당 속성이 변경되었을 때 호출할 함수입니다.

비동기 처리가 필요한 경우라면 관찰 속성을 사용하거나 이벤트 처리 방법을 적용하면 됩니다.

### 3.4 v-cloak 디렉티브

템플릿의 문자열이 잠깐 나타났다가 사라지는 현상을 보이지 않게 처리할 수 있는 방법으로 v-cloak이 있습니다.

```
<template>
  <section v-cloak>
    문자열
  </section>
</template>
<style>
  [v-cloak]{
    display: none;
  }
</style>
```

템플릿 문자열이 일시적으로 나타나는 현상이 사라진 것을 확인할 수 있습니다.

### 3.5 Vue 인스턴트 라이플 사이클

Vue 인스턴스는 객체로 생성되고, 데이터에 대한 관찰 기능을 성정하는 등의 작업을 위해 초기화를 수행합니다. 그리고 이 과정에서 다양한 라이플 사이클 훅 매서드를 적용할 수 있습니다.

라이플 사이클 훅
- beforeCreate :Vue 인스턴스가 생성되고 데이터에 대한 관찰 기능 및 이벤트 감시자 설정 전에 호출됩니다.
- create :Vue 인스턴스가 생성된 후에 데이터에 대한 괄찰 기능, 계산된 속성, 메서드, 감시자 설정이 완료된 후에 호출됩니다.
- beforeMount : 마운트가 시작되기 전에 호출됩니다.
- mounted : el에 vue 인스턴스의 데이터가 마운트된 후에 호출됩니다.
- beforeUpdate : 가상 DOM이 랜더링, 퍂치되기 전에 데이터가 변경될 때 호출됩니다. 이 훅에서 추가적인 상태 변경을 실행할 수 있습니다. 하지만 추가로 다시 랜더링하지 않습니다.
- updated : 데이터의 변경으로 가상 DOM이 다시 랜더링되고 패치된 후에 호출됩니다. 이 훅이 호출되었을 때는 이미 컴포넌트의 DOM이 업데이트된 상태입니다. 그래서 DOM에 종속성이 있는 연산을 이 단계에서 수행할 수 있습니다.
- beforeDestroy : Vue 인스턴스가 제거되기 전에 호출됩니다.
- destroyed : Vue 인스턴스가 제거된 후에 호출됩니다. 이 훅이 호출될 때는 Vue 인스턴스의 모든 디렉티브의 바인딩이 해제되고, 이벤트 연결도 모두 제거됩니다.

![Vue 인스턴스 라이플 시이클 훅 다이어그램](https://kr.vuejs.org/images/lifecycle.png)